--Generar un disparador que haga lo siguiente: Verificar que al insertar el tercer registro en la tabla trabajador, los borre  y los copie a los 3 en la tabla respaldo. 
--Siempre debe funcionar asi, jamas deberan haber mas de 3 registro en trabajador. 

CREATE TABLE TRABAJADOR2(ID INTEGER PRIMARY KEY, NOMBRE VARCHAR2(20), SUELDO_BASE FLOAT);
CREATE TABLE RESPALDO2(ID INTEGER PRIMARY KEY, NOMBRE VARCHAR2(20), SUELDO_BASE FLOAT);

INSERT INTO TRABAJADOR2 VALUES (1,'Juan',1600);
INSERT INTO TRABAJADOR2 VALUES (2,'Pedro',2000);
INSERT INTO TRABAJADOR2 VALUES (3,'Luis',1200);

CREATE OR REPLACE PROCEDURE CONTAR_TRABAJADOR2(NUMERO OUT INTEGER)
AS
BEGIN
SELECT COUNT(*) INTO NUMERO FROM TRABAJADOR2;
END;
/

DECLARE 
VALOR INTEGER;
BEGIN
CONTAR_TRABAJADOR2(VALOR);
END;
/

CREATE OR REPLACE PROCEDURE COPIAR 
AS
CURSOR CUR_TRABAJADOR2 IS SELECT * FROM TRABAJADOR2;
BEGIN
FOR REC2 IN CUR_TRABAJADOR2 LOOP
INSERT INTO RESPALDO2 VALUES(REC2.ID, REC2.NOMBRE, REC2.SUELDO_BASE);
END LOOP;
END;
/

CREATE OR REPLACE TRIGGER DISP_TRABAJADOR2 BEFORE INSERT ON TRABAJADOR2 FOR EACH ROW
DECLARE
VALOR INTEGER;
BEGIN
CONTAR_TRABAJADOR2(VALOR);
IF  VALOR = 3 THEN
COPIAR();
DELETE FROM TRABAJADOR2;
END IF;
END;
/

INSERT INTO TRABAJADOR2 VALUES (4,'Jose',200);
INSERT INTO TRABAJADOR2 VALUES (5,'Ana',1500);
INSERT INTO TRABAJADOR2 VALUES (6,'Maria',100);

SELECT * FROM RESPALDO2;
SELECT * FROM TRABAJADOR2;

INSERT INTO TRABAJADOR2 VALUES (7,'Jose',200);
INSERT INTO TRABAJADOR2 VALUES (8,'Ana',1500);
INSERT INTO TRABAJADOR2 VALUES (9,'Maria',100);

SELECT * FROM RESPALDO2;
SELECT * FROM TRABAJADOR2;
